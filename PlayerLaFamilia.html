<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ByDesign">
    <meta name="keywords" content="ByDesign">
    <title>ByDesign</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
body {
    overflow: hidden;
    margin: 0;
    font-family: 'Arial', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background: url('https://i.imgur.com/7V5Kf1T.gif') no-repeat center center fixed;
    background-size: cover;
    color: #e0e0e0;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
}

.radio-player-container {
    background-color: rgba(27, 27, 27, 0.5);
    padding: 15px 20px;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
    text-align: center;
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    max-width: 500px;
    width: 90%;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.now-playing-section {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 20px;
    background-color: rgba(0, 0, 0, 0.4);
    padding: 15px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    width: 100%;
    box-sizing: border-box;
}

.album-art {
    width: 100px;
    height: 100px;
    border-radius: 8px;
    object-fit: cover;
    flex-shrink: 0;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
}

.current-info {
    text-align: left;
    flex-grow: 1;
}

.current-info p {
    margin: 8px 0;
    font-size: 1.1em;
    color: #1dd4ce;
}

.current-info span {
    font-weight: bold;
    color: #ffe0b5;
}

#audioVisualizer {
    width: 100%;
    height: 100px;
    background-color: rgba(0, 0, 0, 0.5);
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: inset 0 0 10px rgb(37, 233, 255);
}

.controls {
    justify-content: center;
    display: flex;
    gap: 25px;
    margin-bottom: 25px;
    width: 100%;
}

.player-button {
    background-color: #f5a123ce;
    color: rgb(195, 240, 255);
    font-weight: bold;
    border: none;
    padding: 5px 15px;
    border-radius: 25px;
    font-size: 1.2em;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
    outline: none;
    box-shadow: 0 4px 10px rgba(253, 253, 253, 0.3);
}

.player-button:hover {
    background-color: #ffe2a4;
    color: #0b0b0b;
    transform: translateY(-2px);
    box-shadow: 3px 3px 25px rgba(255, 255, 255, 0.4);
}

.player-button:active {
    background-color: #aeffb2;
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(255, 255, 255, 0.3);
}

.player-button.playing {
    background-color: #c13228;
}

.player-button.playing:hover {
    background-color: #ff837a;
    color: #181818;
}

.player-button.playing:active {
    background-color: #c13228;
}

.volume-control {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-top: 15px;
}

.volume-control label {
    font-size: 1.1em;
    color: #ffe3ab;
}

#volumeSlider {
    width: 70%;
    height: 10px;
    background: #870a87;
    border-radius: 5px;
    outline: none;
    transition: background 0.2s ease;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
}

#volumeSlider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #00e5ff;
    cursor: pointer;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    transition: background 0.2s ease, transform 0.2s ease;
}

#volumeSlider::-moz-range-thumb {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #00e5ff;
    cursor: pointer;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    transition: background 0.2s ease, transform 0.2s ease;
}

#volumeSlider::-webkit-slider-thumb:hover {
    background: #00b8d4;
    transform: scale(1.1);
}

#volumeSlider::-moz-range-thumb:hover {
    background: #00b8d4;
    transform: scale(1.1);
}

.status-message {
    margin-top: 20px;
    font-size: 1.1em;
    color: #ffe2a4;
    font-style: italic;
}

.song-history {
    margin-top: 10px;
    text-align: left;
    background-color: rgba(0, 0, 0, 0.3);
    padding: 10px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    width: 100%;
    box-sizing: border-box;
}

.song-history h2 {
    color: #23c5bd;
    font-size: 1.5em;
    margin-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding-bottom: 10px;
}

.song-history ul {
    list-style: none;
    padding: 0;
    max-height: 160px;
    overflow-y: auto;
}

.song-history li {
    font-size: 0.95em;
    margin-bottom: 8px;
    color: #faffed;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.song-history ul::-webkit-scrollbar {
    width: 8px;
}

.song-history ul::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
}

.song-history ul::-webkit-scrollbar-thumb {
    background: #6a1b9a;
    border-radius: 10px;
}

.song-history ul::-webkit-scrollbar-thumb:hover {
    background: #512da8;
}

.ball {
    position: absolute;
    border-radius: 100%;
    opacity: 0.7;
}

        .floating-buttons-container {
            position: fixed;
            bottom: 2.5rem;
            right: 2.5rem;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .floating-button {
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .floating-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
        }

        .floating-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        @media (max-width: 640px) {
            .floating-buttons-container {
                bottom: 1rem;
                right: 1rem;
                gap: 0.5rem;
            }
            .floating-button {
                padding: 0.75rem 1.25rem;
                font-size: 0.875rem;
            }
        }

@media (max-width: 768px) {
    .main-content-wrapper {
        flex-direction: column;
        gap: 0;
        align-items: center;
    }

    .radio-player-container {
        margin-bottom: 20px;
        z-index: 2;
    }
}
    </style>
</head>
<body>
    <div class="radio-player-container">
        <img src="https://i.imgur.com/ir1Fv0O.png" alt="Titulo">
        <div class="now-playing-section">
            <img id="albumArt" src="https://technoplayerserver.net/cp/musiclibrary/nowplay_radioxatoficial.png" alt="Album Art" class="album-art">
            <div class="current-info">
                <p>Acum Live: <span id="songTitle">Încărcare...</span></p>
                <p>DJ: <span id="djName">Încărcare...</span></p>
                <p>Ascultatori: <span id="listeners">Încărcare...</span></p>
            </div>
        </div>

        <canvas id="audioVisualizer"></canvas>

        <div class="controls">
            <button id="playStopButton" class="player-button play">Play</button>
            <div class="volume-control">
                <label for="volumeSlider">Volum:</label>
                <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1">
            </div>
            <div id="status" class="status-message">Play!</div>
        </div>
        
        <div class="song-history">
            <h2>Istoric</h2>
            <ul id="historyList">
                <li>Încă nu este disponibil istoricul.</li>
            </ul>
        </div>
        
    </div>
    <div class="floating-buttons-container">
        <button
            id="chatButton"
            class="floating-button bg-blue-600 text-white font-bold py-3 px-6 rounded-full flex items-center space-x-2
                hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75"
        >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                <path d="M12.525 2.166a9.962 9.962 0 0 1 1.666 4.336c-.026.007-.052.014-.078.021-.86.23-1.657.65-2.34 1.233-.683.583-1.24 1.29-1.657 2.08-.417.79-.683 1.66-.79 2.58-.107.92-.107 1.88-.001 2.81.106.93.362 1.81.765 2.62.403.81.95 1.52 1.633 2.12.683.6 1.46 1.05 2.34 1.34.88.29 1.81.43 2.76.43a9.962 9.962 0 0 0 4.336-1.666V12.525h-2.166a.75.75 0 0 1-.75-.75V8.875a.75.75 0 0 1 .75-.75h2.166V4.336a9.962 9.962 0 0 0-1.666-4.336z" />
            </svg>
            <span>Chat</span>
        </button>

        <button
            id="SiteButton"
            class="floating-button bg-black text-white font-bold py-3 px-6 rounded-full flex items-center space-x-2
                hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-600 focus:ring-opacity-75"
        >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                <path d="M12.525 2.166a9.962 9.962 0 0 1 1.666 4.336c-.026.007-.052.014-.078.021-.86.23-1.657.65-2.34 1.233-.683.583-1.24 1.29-1.657 2.08-.417.79-.683 1.66-.79 2.58-.107.92-.107 1.88-.001 2.81.106.93.362 1.81.765 2.62.403.81.95 1.52 1.633 2.12.683.6 1.46 1.05 2.34 1.34.88.29 1.81.43 2.76.43a9.962 9.962 0 0 0 4.336-1.666V12.525h-2.166a.75.75 0 0 1-.75-.75V8.875a.75.75 0 0 1 .75-.75h2.166V4.336a9.962 9.962 0 0 0-1.666-4.336z" />
            </svg>
            <span>Site</span>
        </button>
    </div>
<script>
    const audio = new Audio('https://radio.sonicpanel.ro/8132/stream');
audio.crossOrigin = "anonymous";

const playStopButton = document.getElementById('playStopButton');
const volumeSlider = document.getElementById('volumeSlider');
const statusDisplay = document.getElementById('status');

const songTitleDisplay = document.getElementById('songTitle');
const djNameDisplay = document.getElementById('djName');
const listenersDisplay = document.getElementById('listeners');
const historyList = document.getElementById('historyList');
const albumArtDisplay = document.getElementById('albumArt');

const audioVisualizer = document.getElementById('audioVisualizer');
const canvasCtx = audioVisualizer.getContext('2d');

let isPlaying = false;
const API_URL = 'https://radio.sonicpanel.ro/cp/get_info.php?p=8132';
const UPDATE_INTERVAL = 10000; // Update API data every 10 seconds

let audioContext;
let analyser;
let source;
let dataArray;
let bufferLength;

function resizeCanvas() {
    audioVisualizer.width = audioVisualizer.offsetWidth;
    audioVisualizer.height = audioVisualizer.offsetHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function setupAudioContext() {
    if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        source = audioContext.createMediaElementSource(audio);
        analyser = audioContext.createAnalyser();

        source.connect(analyser);
        analyser.connect(audioContext.destination);

        analyser.fftSize = 256;
        bufferLength = analyser.frequencyBinCount;
        dataArray = new Uint8Array(bufferLength);
    }
}

function drawVisualizer() {
    if (!isPlaying) {
        canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);
        return;
    }

    requestAnimationFrame(drawVisualizer);
    if (!analyser || !dataArray) {
        console.warn("Analyser or dataArray not ready for visualization.");
        return;
    }

    analyser.getByteFrequencyData(dataArray);

    canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);

    const barWidth = (audioVisualizer.width / bufferLength) * 2.5;
    let x = 0;

    for (let i = 0; i < bufferLength; i++) {
        const barHeight = dataArray[i] / 2;

        const gradient = canvasCtx.createLinearGradient(0, audioVisualizer.height, 0, 0);
        gradient.addColorStop(0, '#673ab7');
        gradient.addColorStop(0.5, '#00e5ff');
        gradient.addColorStop(1, '#FFC107');

        canvasCtx.fillStyle = gradient;
        canvasCtx.fillRect(x, audioVisualizer.height - barHeight, barWidth, barHeight);

        x += barWidth + 1;
    }
}

audio.volume = volumeSlider.value;

playStopButton.addEventListener('click', async () => {
    if (isPlaying) {
        audio.pause();
        playStopButton.textContent = 'Play';
        playStopButton.classList.remove('playing');
        statusDisplay.textContent = 'Detenido';
        isPlaying = false;
        if (audioContext && audioContext.state === 'running') {
            await audioContext.suspend();
            console.log("AudioContext suspended.");
        }
        canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);
    } else {
        setupAudioContext();
        if (audioContext && audioContext.state === 'suspended') {
            await audioContext.resume();
            console.log("AudioContext resumed.");
        }

        audio.play().then(() => {
            playStopButton.textContent = 'Stop';
            playStopButton.classList.add('playing');
            statusDisplay.textContent = 'Live...';
            isPlaying = true;
            drawVisualizer();
        }).catch(error => {
            console.error("Error playing audio:", error);
            statusDisplay.textContent = 'Error playing stream.';
            playStopButton.textContent = 'Play';
            playStopButton.classList.remove('playing');
            isPlaying = false;
            if (audioContext && audioContext.state === 'running') {
                audioContext.suspend();
            }
            canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);
        });
    }
});

volumeSlider.addEventListener('input', () => {
    audio.volume = volumeSlider.value;
});

audio.addEventListener('playing', () => {
    statusDisplay.textContent = 'On Line...';
    isPlaying = true;
    playStopButton.textContent = 'Detener';
    playStopButton.classList.add('playing');
    drawVisualizer();
});

audio.addEventListener('pause', () => {
    if (!isPlaying) {
        statusDisplay.textContent = 'Play';
        playStopButton.textContent = 'Play';
        playStopButton.classList.remove('playing');
        canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);
    } else {
        statusDisplay.textContent = 'Pausado';
        playStopButton.textContent = 'Play';
        playStopButton.classList.remove('playing');
        canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);
        if (audioContext && audioContext.state === 'running') {
            audioContext.suspend();
        }
    }
    isPlaying = false;
});


audio.addEventListener('ended', () => {
    statusDisplay.textContent = 'Stream Ended';
    isPlaying = false;
    playStopButton.textContent = 'Play';
    playStopButton.classList.remove('playing');
    if (audioContext && audioContext.state === 'running') {
        audioContext.suspend();
    }
    canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);
});

audio.addEventListener('error', (e) => {
    console.error("Audio error:", e);
    statusDisplay.textContent = 'Error: Could not load stream.';
    isPlaying = false;
    playStopButton.textContent = 'Play';
    playStopButton.classList.remove('playing');
    if (audioContext && audioContext.state === 'running') {
        audioContext.suspend();
    }
    canvasCtx.clearRect(0, 0, audioVisualizer.width, audioVisualizer.height);
});

audio.addEventListener('waiting', () => {
    statusDisplay.textContent = 'Buffering...';
});

audio.addEventListener('stalled', () => {
    statusDisplay.textContent = 'Connection stalled. Retrying...';
});

fetchRadioInfo();
setInterval(fetchRadioInfo, UPDATE_INTERVAL);

async function fetchRadioInfo() {
    try {
        const response = await fetch(API_URL);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const data = await response.json();
        songTitleDisplay.textContent = data.title || 'Unknown Title';

        if (data.djusername && data.djusername.toLowerCase() !== "no dj") {
            djNameDisplay.textContent = data.djusername;
        } else {
            djNameDisplay.textContent = 'AutoDJ';
        }

        listenersDisplay.textContent = data.listeners || 'N/A';

        if (data.art) {
            albumArtDisplay.src = data.art;
        } else {
            albumArtDisplay.src = data.art;
        }

        historyList.innerHTML = '';
        if (data.history && data.history.length > 0) {
            const lastFiveSongs = data.history.slice(0, 5);
            lastFiveSongs.forEach((song, index) => {
                const li = document.createElement('li');
                const cleanSong = song.replace(/^\d+\.\)\s*/, '').replace(/<br>/gi, '').trim();
                li.textContent = `${index + 1}.) ${cleanSong}`;
                historyList.appendChild(li);
            });
        } else {
            const li = document.createElement('li');
            li.textContent = 'No history available.';
            historyList.appendChild(li);
        }

    } catch (error) {
        console.error("Failed to fetch radio info:", error);
        songTitleDisplay.textContent = 'Failed to load';
        djNameDisplay.textContent = 'Failed to load';
        listenersDisplay.textContent = 'Failed to load';
        albumArtDisplay.src = 'https://technoplayerserver.net/cp/musiclibrary/nowplay_radioxatoficial.png';
        historyList.innerHTML = '<li>Error loading history.</li>';
    }
}

const colors = ["#3CC157", "#2AA7FF", "#1B1B1B", "#FCBC0F", "#F85F36"];

const numBalls = 50;
const balls = [];

for (let i = 0; i < numBalls; i++) {
    let ball = document.createElement("div");
    ball.classList.add("ball");
    ball.style.background = colors[Math.floor(Math.random() * colors.length)];
    ball.style.left = `${Math.floor(Math.random() * 100)}vw`;
    ball.style.top = `${Math.floor(Math.random() * 100)}vh`;
    ball.style.transform = `scale(${Math.random()})`;
    ball.style.width = `${Math.random()}em`;
    ball.style.height = ball.style.width;

    balls.push(ball);
    document.body.append(ball);
}

    balls.forEach((el, i, ra) => {
    let to = {
    x: Math.random() * (i % 2 === 0 ? -11 : 11),
    y: Math.random() * 12
};

    let anim = el.animate(
    [
    { transform: "translate(0, 0)" },
    { transform: `translate(${to.x}rem, ${to.y}rem)` }
    ],
    {
        duration: (Math.random() + 1) * 2000,
        direction: "alternate",
        fill: "both",
        iterations: Infinity,
        easing: "ease-in-out"
    }
);
});

        const chatButton = document.getElementById('chatButton');
        const SiteButton = document.getElementById('SiteButton');

        chatButton.addEventListener('click', () => {
            const facebookUrl = 'https://www.facebook.com/people/Radio-Hispanohablante/61573727018441/';
            window.open(chatUrl, '_blank');
        });

        SiteButton.addEventListener('click', () => {
            const tiktokUrl = 'https://www.tiktok.com/@radiohispano';
            window.open(SiteUrl, '_blank');
        });
</script>
</body>
</html>
